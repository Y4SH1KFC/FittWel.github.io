<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lo que no se olvida - Momentos</title>
  <link rel="stylesheet" href="Polaroid.css" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Quicksand&display=swap"
    rel="stylesheet" />
</head>

<body>
  <header>
    <h1 class="titulo-seccion">Recuerdos que no se olvidan</h1>
  </header>

  <main>
    <section id="momentos" class="momentos-section">
      <div class="galeria" id="galeria"></div>
    </section>
  </main>

  <footer>
    <div style="text-align:center; margin: 2rem;">
      <a href="index.html" class="btn-explorar">Regresar</a>
      <a href="cumple.html" class="btn-explorar">¿Quieres ver algo más?</a>
    </div>
  </footer>

  <script>
    // Función para cargar el JSON con los datos
    async function cargarTarjetas() {
        try {
          const response = await fetch('frases.json');
          const data = await response.json();

          const galeria = document.getElementById('galeria');

          data.tarjetas.forEach((tarjeta, index) => {
            const div = document.createElement('div');
            div.className = 'tarjeta';

            if (tarjeta.tipo === 'video') {
              const video = document.createElement('video');
              video.src = tarjeta.src;
              video.controls = true;
              video.loop = true;
              video.autoplay = true;
              video.muted = true;
              video.preload = 'metadata';
              video.className = 'media';
              div.appendChild(video);
            } else if (tarjeta.tipo === 'foto') {
              const img = document.createElement('img');
              img.src = tarjeta.src;
              img.alt = `Foto ${index + 1}`;
              img.className = 'media';
              div.appendChild(img);
            }

            const p = document.createElement('p');
            p.className = 'frase';
            p.textContent = tarjeta.frase;
            div.appendChild(p);

            galeria.appendChild(div);
          });

          // Ajustar altura visual de cada tarjeta para grid masonry
          setTimeout(() => {
            const tarjetasElements = document.querySelectorAll('.tarjeta');
            tarjetasElements.forEach((el) => {
              const altura = el.getBoundingClientRect().height;
              const fila = 5; // mismo valor que grid-auto-rows
              const filas = Math.ceil(altura / fila);
              el.style.gridRowEnd = `span ${filas}`;
            });

            // Aquí activamos ScrollReveal después que las tarjetas ya están listas
            ScrollReveal().reveal('.tarjeta', {
              origin: 'bottom',
              distance: '40px',
              duration: 900,
              easing: 'ease-out',
              interval: 150,
              opacity: 0,
              reset: false
            });
          }, 150);

        } catch (error) {
          console.error('Error cargando tarjetas:', error);
        }
      }

      window.addEventListener('load', cargarTarjetas);

  </script>

</body>

</html>